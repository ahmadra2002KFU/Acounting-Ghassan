"""
Seed database with demo data from the original static app
"""
from app import app
from models import *

def seed_database():
    """Populate database with demo data"""
    with app.app_context():
        # Drop all tables and recreate
        db.drop_all()
        db.create_all()

        print("Seeding database with demo data...")

        # 1. Config
        config = Config(
            functional_currency='SAR',
            vat_rate=0.15,
            costing='FIFO'
        )
        db.session.add(config)

        # 2. Branches (10)
        branches_data = [
            (1, "الرياض"),
            (2, "جدة"),
            (3, "مكة"),
            (4, "المدينة المنورة"),
            (5, "الدمام"),
            (6, "الخبر"),
            (7, "الطائف"),
            (8, "تبوك"),
            (9, "بريدة"),
            (10, "أبها")
        ]
        for branch_id, name in branches_data:
            db.session.add(Branch(id=branch_id, name=name))

        # 3. Cost Centers (20 - 2 per branch)
        cost_centers = []
        for branch_id, branch_name in branches_data:
            cc_id_prefix = str(branch_id).zfill(2)
            cost_centers.append(CostCenter(id=f"{cc_id_prefix}01", name=f"{branch_name} - مبيعات"))
            cost_centers.append(CostCenter(id=f"{cc_id_prefix}02", name=f"{branch_name} - إدارة"))
        for cc in cost_centers:
            db.session.add(cc)

        # 4. Currencies (3)
        currencies_data = [
            ('SAR', 'Saudi Riyal', True),
            ('USD', 'US Dollar', False),
            ('EUR', 'Euro', False)
        ]
        for code, name, functional in currencies_data:
            db.session.add(Currency(code=code, name=name, functional=functional))

        # 5. Items (20)
        items_data = [
            ("EL-IPH13-128", "هاتف ذكي iPhone 13 128GB", "قطعة", "إلكترونيات", "هواتف", 5000),
            ("EL-GS23-256", "هاتف ذكي Galaxy S23 256GB", "قطعة", "إلكترونيات", "هواتف", 4200),
            ("EL-LTP-15Y", "حاسوب محمول 15\" موديل Y", "قطعة", "إلكترونيات", "حواسيب", 3500),
            ("EL-LTP-14X", "حاسوب محمول 14\" موديل X", "قطعة", "إلكترونيات", "حواسيب", 3800),
            ("EL-TAB-10A", "جهاز لوحي 10\" موديل A", "قطعة", "إلكترونيات", "أجهزة لوحية", 1500),
            ("EL-TV-55UHD", "شاشة تلفاز 55\" UHD", "قطعة", "إلكترونيات", "شاشات", 2400),
            ("EL-RTR-AC", "راوتر مزدوج النطاق AC", "قطعة", "إلكترونيات", "شبكات", 250),
            ("EL-HPH-BT", "سماعات رأس لاسلكية BT", "قطعة", "إلكترونيات", "ملحقات صوت", 300),
            ("EL-SWATCH", "ساعة ذكية موديل S", "قطعة", "إلكترونيات", "أجهزة قابلة للارتداء", 900),
            ("HM-BLND-A", "خلاط كهربائي موديل A", "قطعة", "أدوات منزلية", "أجهزة صغيرة", 220),
            ("HM-KTL-B", "غلاية ماء كهربائية B", "قطعة", "أدوات منزلية", "أجهزة صغيرة", 180),
            ("HM-VCM-2K", "مكنسة كهربائية 2 كيلوبايت", "قطعة", "أدوات منزلية", "تنظيف", 650),
            ("HM-MWO-25L", "ميكروويف 25 لتر", "قطعة", "أدوات منزلية", "مطابخ", 500),
            ("HM-AFR-5L", "قلاية هوائية 5 لتر", "قطعة", "أدوات منزلية", "مطابخ", 450),
            ("HM-IRON-S", "مكواة بخار منزلية", "قطعة", "أدوات منزلية", "أجهزة صغيرة", 140),
            ("HM-MXR-600", "عجانة 600 واط", "قطعة", "أدوات منزلية", "مطابخ", 550),
            ("HM-FAN-16", "مروحة أرضية 16\"", "قطعة", "أدوات منزلية", "تبريد وتهوية", 200),
            ("HM-HET-2K", "مدفأة كهربائية 2000 واط", "قطعة", "أدوات منزلية", "تدفئة", 260),
            ("HM-CMKR-1L", "صانعة قهوة 1 لتر", "قطعة", "أدوات منزلية", "مطابخ", 320),
            ("HM-TSTR-4S", "محمصة خبز 4 شرائح", "قطعة", "أدوات منزلية", "مطابخ", 170)
        ]
        for sku, name, uom, cat4, cat5, price in items_data:
            db.session.add(Item(sku=sku, name=name, uom=uom, cat4=cat4, cat5=cat5))
            db.session.add(Price(sku=sku, price=price))

        # 6. Item GL Mapping
        mapping_data = [
            ("هواتف", "1-03-01-010-001", "4-01-01-001-000", "5-01-01-001-000"),
            ("حواسيب", "1-03-01-010-002", "4-01-01-002-000", "5-01-01-002-000"),
            ("أجهزة لوحية", "1-03-01-020-000", "4-01-01-003-000", "5-01-01-003-000"),
            ("شاشات", "1-03-01-030-000", "4-01-01-004-000", "5-01-01-004-000"),
            ("شبكات", "1-03-01-040-000", "4-01-01-005-000", "5-01-01-005-000"),
            ("ملحقات صوت", "1-03-01-050-000", "4-01-01-006-000", "5-01-01-006-000"),
            ("أجهزة قابلة للارتداء", "1-03-01-060-000", "4-01-01-007-000", "5-01-01-007-000"),
            ("أجهزة صغيرة", "1-03-02-010-000", "4-01-02-001-000", "5-01-02-001-000"),
            ("مطابخ", "1-03-02-020-000", "4-01-02-002-000", "5-01-02-002-000"),
            ("تنظيف", "1-03-02-030-000", "4-01-02-003-000", "5-01-02-003-000"),
            ("تبريد وتهوية", "1-03-02-040-000", "4-01-02-004-000", "5-01-02-004-000"),
            ("تدفئة", "1-03-02-050-000", "4-01-02-005-000", "5-01-02-005-000")
        ]
        for category, inv, sales, cogs in mapping_data:
            db.session.add(ItemGLMapping(category=category, inv_account=inv, sales_account=sales, cogs_account=cogs))

        # 7. Chart of Accounts (70+ accounts)
        coa_data = [
            # نقد وبنوك
            ("1-01-01-001-001", "صندوق المقر الرئيسي", "D"),
            ("1-01-02-001-001", "حساب جاري - بنك الأهلي (ريال)", "D"),
            # ذمم
            ("1-02-01-000-000", "العملاء (رئيسي)", "D"),
            ("1-02-02-000-000", "أوراق قبض", "D"),
            # مخزون — إلكترونيات
            ("1-03-01-010-000", "مخزون إلكترونيات (رئيسي)", "D"),
            ("1-03-01-010-001", "مخزون - هواتف", "D"),
            ("1-03-01-010-002", "مخزون - حواسيب", "D"),
            ("1-03-01-020-000", "مخزون - أجهزة لوحية", "D"),
            ("1-03-01-030-000", "مخزون - شاشات", "D"),
            ("1-03-01-040-000", "مخزون - شبكات", "D"),
            ("1-03-01-050-000", "مخزون - ملحقات صوت", "D"),
            ("1-03-01-060-000", "مخزون - أجهزة قابلة للارتداء", "D"),
            # مخزون — أدوات منزلية
            ("1-03-02-010-000", "مخزون - أجهزة صغيرة", "D"),
            ("1-03-02-020-000", "مخزون - مطابخ", "D"),
            ("1-03-02-030-000", "مخزون - تنظيف", "D"),
            ("1-03-02-040-000", "مخزون - تبريد وتهوية", "D"),
            ("1-03-02-050-000", "مخزون - تدفئة", "D"),
            # بضاعة بالطريق
            ("1-03-99-000-000", "بضاعة بالطريق", "D"),
            # موردون/ضرائب
            ("2-01-01-000-000", "موردون (رئيسي)", "C"),
            ("2-01-01-001-001", "مورد إلكترونيات - ABC", "C"),
            ("2-02-01-001-000", "ضريبة قيمة مضافة مخرجات 15%", "C"),
            ("2-03-01-001-000", "ضريبة قيمة مضافة مدخلات 15%", "D"),
            ("2-04-01-000-000", "رسوم جمركية مستحقة", "C"),
            # حقوق ملكية
            ("3-01-01-001-000", "رأس المال - الشريك أ", "C"),
            ("3-02-01-001-000", "أرباح مبقاة - سنوات سابقة", "C"),
            # إيرادات (سلاسل)
            ("4-01-01-000-000", "مبيعات إلكترونيات (رئيسي)", "C"),
            ("4-01-01-001-000", "مبيعات - هواتف", "C"),
            ("4-01-01-002-000", "مبيعات - حواسيب", "C"),
            ("4-01-01-003-000", "مبيعات - أجهزة لوحية", "C"),
            ("4-01-01-004-000", "مبيعات - شاشات", "C"),
            ("4-01-01-005-000", "مبيعات - شبكات", "C"),
            ("4-01-01-006-000", "مبيعات - ملحقات صوت", "C"),
            ("4-01-01-007-000", "مبيعات - أجهزة قابلة للارتداء", "C"),
            ("4-01-02-001-000", "مبيعات - أجهزة منزلية صغيرة", "C"),
            ("4-01-02-002-000", "مبيعات - مطابخ", "C"),
            ("4-01-02-003-000", "مبيعات - تنظيف", "C"),
            ("4-01-02-004-000", "مبيعات - تبريد وتهوية", "C"),
            ("4-01-02-005-000", "مبيعات - تدفئة", "C"),
            ("4-02-01-000-000", "مردودات مبيعات", "D"),
            # تكلفة مبيعات
            ("5-01-01-001-000", "تكلفة المبيعات - هواتف", "D"),
            ("5-01-01-002-000", "تكلفة المبيعات - حواسيب", "D"),
            ("5-01-01-003-000", "تكلفة المبيعات - أجهزة لوحية", "D"),
            ("5-01-01-004-000", "تكلفة المبيعات - شاشات", "D"),
            ("5-01-01-005-000", "تكلفة المبيعات - شبكات", "D"),
            ("5-01-01-006-000", "تكلفة المبيعات - ملحقات صوت", "D"),
            ("5-01-01-007-000", "تكلفة المبيعات - أجهزة قابلة للارتداء", "D"),
            ("5-01-02-001-000", "تكلفة المبيعات - أجهزة منزلية صغيرة", "D"),
            ("5-01-02-002-000", "تكلفة المبيعات - مطابخ", "D"),
            ("5-01-02-003-000", "تكلفة المبيعات - تنظيف", "D"),
            ("5-01-02-004-000", "تكلفة المبيعات - تبريد وتهوية", "D"),
            ("5-01-02-005-000", "تكلفة المبيعات - تدفئة", "D"),
            ("5-02-03-000-000", "جمارك وارد (ضمن التكلفة)", "D"),
            # مصاريف
            ("6-02-01-001-000", "إيجار - فرع الرياض", "D"),
            ("6-02-02-000-000", "رواتب إدارية", "D"),
            ("6-02-03-000-000", "كهرباء ومياه", "D"),
            ("6-02-04-000-000", "اتصالات وإنترنت", "D"),
            ("6-03-01-000-000", "مصروف الإهلاك", "D"),
            # أخرى
            ("7-01-01-000-000", "إيرادات أخرى", "C"),
            ("7-02-01-000-000", "مصاريف أخرى", "D"),
            # ضرائب/زكاة
            ("8-01-01-001-000", "مخصص الزكاة/الضريبة - 2025", "C"),
            ("8-02-01-000-000", "تسويات ضريبة القيمة المضافة", "C")
        ]
        for code, name, side in coa_data:
            db.session.add(ChartOfAccount(code=code, name=name, side=side))

        # 8. Tax Codes
        tax_codes = [
            TaxCode(code="VAT15OUT", type="OUTPUT", rate=0.15, gl="2-02-01-001-000"),
            TaxCode(code="VAT15IN", type="INPUT", rate=0.15, gl="2-03-01-001-000"),
            TaxCode(code="RCM15", type="RCM", rate=0.15, gl_out="2-02-01-001-000", gl_in="2-03-01-001-000")
        ]
        for tax in tax_codes:
            db.session.add(tax)

        db.session.commit()
        print("✓ Database seeded successfully!")
        print(f"  - {len(branches_data)} branches")
        print(f"  - {len(cost_centers)} cost centers")
        print(f"  - {len(items_data)} items with prices")
        print(f"  - {len(coa_data)} chart of accounts")
        print(f"  - {len(mapping_data)} GL mappings")

if __name__ == '__main__':
    seed_database()
